# Курсовой проект 8. Docker

## Сервис Полезных привычек

Для выполнения задания используйте курсовой проект, над которым вы работали в курсе DRF.

### Задание

Cоздайте отдельные контейнеры для сервисов в проекте.

Как минимум для следующих сервисов:

    Django,
    PostrgeSQL,
    Redis,
    Celery.

Как максимум — для всех сервисов проекта.

Весь проект должен запускаться одной командой и при этом иметь возможность быть перенесенным на отдельный удаленный сервер для запуска на нём.


## Локальный запуск проекта

1. Установить Docker на локальную машину. Порядок согласно официальной инструкции.
```
https://docs.docker.com/engine/install/ubuntu/
```
2. Создать файл `.env` в корневой директории проекта и прописать в нем значение следующих переменных:

```
• SECRET_KEY=...
• DB_HOST="postgres"
• DB_PORT=5432
• DB_NAME=...
• DB_USER=...
• DB_PASSWORD=...
• TG_TOKEN=...
```

3. Создать образ приложения с помощью команды:
```bash
$ docker compose build .
```
4. Запустить контейнеры из с помощью команды:
```bash
$ docker compose up -d
```


## Размещение и запуск проекта на удаленном сервере

1. Подключиться через SSH к удаленному серверу.

2. Установить Docker на сервер. Порядок согласно официальной инструкции.
```
https://docs.docker.com/engine/install/ubuntu/
```

3. Создать папку проекта на удаленном сервере.
```bash
$ mkdir atomic_habits && cd atomic_habits
```

4. Создать файл `.env` в корневой директории проекта на удаленном сервере и прописать в нем значение следующих переменных:

• SECRET_KEY=...
• DB_HOST="postgres"
• DB_PORT=5432
• DB_NAME=...
• DB_USER=...
• DB_PASSWORD=...
• TG_TOKEN=...

5. Скопировать папки и файлы проекта на удаленный сервер. Команды выполняются на своем компьютере:
```bash
$ scp <путь до проекта>/data <имя>@<адрес>: .
$ scp <путь до проекта>/postgresdata <имя>@<адрес>: .
$ scp <путь до проекта>/docker_compose_server.yaml <имя>@<адрес>: docker_compose.yaml
```
Если необходимо создать приложение с чистой базой данных, первые два файла копировать нет необходимости.

6. Подключиться к серверу через SSH. Перейти в директорию проекта. Выполнить команду:
```bash
$ docker compose up -d
```
